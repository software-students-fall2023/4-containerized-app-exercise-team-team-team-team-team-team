<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home screen</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oxygen+Mono">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oxanium">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        #emotionSpotify {
            z-index: 10;
            position: fixed;
            bottom: 5%;
            margin: 10px;
            width: 50%;
            background-color: #fff9ef;
            text-align: center;
        }

        h1,
        p {
            font-family: 'Oxygen Mono', monospace;
        }

        .header-container {
            position: fixed;
            top: 0;
            width: 100%;
            background-color: #FFF9EF;
            text-align: center;
            padding: 10px 0;
            box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 3px;
            z-index: 1000;
        }


        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #fff9ef;
        }

        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding-top: 60px;
            /* Added padding to account for the fixed header */
            text-align: center;
            margin: 0 auto;
            background-color: #FFF9EF;
        }

        #emotionPieChart {
            max-width: 700px;
            max-height: 500px;
        }

        .emotion-display {
            font-weight: bold;
            font-size: 24px;
            margin-top: 20px;
        }
    </style>
</head>

<body>

    <div class="header-container">
        <h1>Ponyo Feels</h1>
        <p>How are you feeling today?</p>
    </div>

    <div class="container">

        <div class="emotion-display">
            <p>You seem to be feeling: {{ emotion }}</p>
        </div>
        <canvas id="emotionPieChart"></canvas>

    </div>

    <div class = "container">
        <iframe id="emotionSpotify" style="border-radius:12px"
        src="https://open.spotify.com/embed/track/7mebNFbb0ehL1IX1DMktdC?utm_source=generator" width="100%" height="352"
        frameBorder="0" allowfullscreen=""
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>

    </div>

  
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            function changeIframeSrc(emotion) {
                var urlMap = {
                    "Admiration": "https://open.spotify.com/embed/track/5zCJvrT3C7cIfHsR5iG95l?utm_source=generator",
                    "Adoration": "https://open.spotify.com/embed/track/4eHbdreAnSOrDDsFfc4Fpm?utm_source=generator",
                    "Aesthetic Appreciation": "https://open.spotify.com/embed/track/1VuBmEauSZywQVtqbxNqka?utm_source=generator",
                    "Amusement": "https://open.spotify.com/embed/track/6AQbmUe0Qwf5PZnt4HmTXv?utm_source=generator",
                    "Anger": "https://open.spotify.com/embed/track/1c8gk2PeTE04A1pIDH9YMk?utm_source=generator",
                    "Anxiety": "https://open.spotify.com/embed/track/0AjQvTAlYcWQ6JpJcUdsKw?utm_source=generator",
                    "Awe": "https://open.spotify.com/embed/track/3e0FzZjTXOUtiJGSClOBrI?utm_source=generator",
                    "Awkwardness": "https://open.spotify.com/embed/track/0wwPcA6wtMf6HUMpIRdeP7?utm_source=generator",
                    "Boredom": "https://open.spotify.com/embed/playlist/37i9dQZF1EIdO8LqmDczC3?utm_source=generator",
                    "Calmness": "https://open.spotify.com/embed/track/7pv80uUHfocFqfTytu1MVi?utm_source=generator",
                    "Concentration": "https://open.spotify.com/embed/track/2HHtWyy5CgaQbC7XSoOb0e?utm_source=generator",
                    "Contemplation": "https://open.spotify.com/embed/track/784VjdNkpXhFV0RHquzsi2?utm_source=generator",
                    "Confusion": "https://open.spotify.com/embed/track/6LgJvl0Xdtc73RJ1mmpotq?utm_source=generator",
                    "Contempt": "https://open.spotify.com/embed/track/564Z6w6IbtUnIO4QLg4y3P?utm_source=generator",
                    "Contentment": "https://open.spotify.com/embed/track/7vggqxNKwd6xdRoYS0pQtM?utm_source=generator",
                    "Craving": "https://open.spotify.com/embed/track/6BrMEbPSSj55nQhkgf6DnE?utm_source=generator",
                    "Determination": "https://open.spotify.com/embed/track/6D60klaHqbCl9ySc8VcRss?utm_source=generator",
                    "Disappointment": "https://open.spotify.com/embed/track/3oEkrIfXfSh9zGnE7eBzSV?utm_source=generator",
                    "Disgust": "https://open.spotify.com/embed/track/4ycLiPVzE5KamivXrAzGFG?utm_source=generator",
                    "Distress": "https://open.spotify.com/embed/track/1wyVyr8OhYsC9l0WgPPbh8?utm_source=generator",
                    "Doubt": "https://open.spotify.com/embed/track/6LgJvl0Xdtc73RJ1mmpotq?utm_source=generator",
                    "Ecstasy": "https://open.spotify.com/embed/track/4PEGwWH4tL6H7dGl4uVSPg?utm_source=generator",
                    "Embarrassment": "https://open.spotify.com/embed/track/70LcF31zb1H0PyJoS1Sx1r?utm_source=generator",
                    "Empathic Pain": "https://open.spotify.com/embed/track/5zCJvrT3C7cIfHsR5iG95l?utm_source=generator",
                    "Entrancement": "https://open.spotify.com/embed/track/2OUPZheGd8XbNQwBMImYnI?utm_source=generator",
                    "Envy": "https://open.spotify.com/embed/track/564Z6w6IbtUnIO4QLg4y3P?utm_source=generator",
                    "Excitement": "https://open.spotify.com/embed/track/6oBEmZu29JqnBDOWZOmm6O?utm_source=generator",
                    "Fear": "https://open.spotify.com/embed/track/2H2379xRxgQVvcOSoL8Ajr?utm_source=generator",
                    "Guilt": "https://open.spotify.com/embed/track/6ucR4KfvsBFWCMVFDvyKKl?utm_source=generator",
                    "Horror": "https://open.spotify.com/embed/track/7ERSQrRptZVM7q3VOdM7OL?utm_source=generator",
                    "Interest": "https://open.spotify.com/embed/track/7mebNFbb0ehL1IX1DMktdC?utm_source=generator",
                    "Joy": "https://open.spotify.com/embed/track/3koCCeSaVUyrRo3N2gHrd8?utm_source=generator",
                    "Love": "https://open.spotify.com/embed/track/7mimnm2QlSzW3J38FRMETP?utm_source=generator",
                    "Nostalgia": "https://open.spotify.com/embed/track/4wCmqSrbyCgxEXROQE6vtV?utm_source=generator",
                    "Pain": "https://open.spotify.com/embed/track/6PypGyiu0Y2lCDBN1XZEnP?utm_source=generator",
                    "Pride": "https://open.spotify.com/embed/track/6Slt6WiWnriaqCb8xXb2ZT?utm_source=generator",
                    "Realization": "https://open.spotify.com/embed/track/7mebNFbb0ehL1IX1DMktdC?utm_source=generator",
                    "Relief": "https://open.spotify.com/embed/track/1vYXt7VSjH9JIM5oRRo7vA?utm_source=generator",
                    "Romance": "https://open.spotify.com/embed/track/4PEGwWH4tL6H7dGl4uVSPg?utm_source=generator",
                    "Sadness": "https://open.spotify.com/embed/track/10nyNJ6zNy2YVYLrcwLccB?utm_source=generator",
                    "Satisfaction": "https://open.spotify.com/embed/track/213yG5o4EISfGoceayLo6u?utm_source=generator",
                    "Desire": "https://open.spotify.com/embed/track/2TmqHjg7uhizGndzXQdFuf?utm_source=generator",
                    "Shame": "https://open.spotify.com/embed/track/70LcF31zb1H0PyJoS1Sx1r?utm_source=generator",
                    "Surprise (negative)": "https://open.spotify.com/embed/track/2Fxmhks0bxGSBdJ92vM42m?utm_source=generator",
                    "Surprise (positive)": "https://open.spotify.com/embed/track/4bHsxqR3GMrXTxEPLuK5ue?utm_source=generator",
                    "Sympathy": "https://open.spotify.com/embed/track/2je7nCHSkWemSHgvLLIc32?utm_source=generator",
                    "Tiredness": "https://open.spotify.com/embed/track/1LzNfuep1bnAUR9skqdHCK?utm_source=generator",
                    "Triumph": "https://open.spotify.com/embed/track/6ATrsVaZT7XjkCynxM8cTS?utm_source=generator"
                };

                var iframe = document.getElementById('emotionSpotify');
                iframe.src = urlMap[emotion] || "default_url_if_emotion_not_found";
            }


            const emotion = "{{ emotion }}";

            changeIframeSrc(emotion);
            const emotionsData = {{ emotions_data | tojson
        }};
        const ctx = document.getElementById('emotionPieChart').getContext('2d');
        const emotionBarChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Object.keys(emotionsData),
                datasets: [{
                    label: 'Emotions',
                    data: Object.values(emotionsData),
                    backgroundColor: 'rgba(255, 165, 0, 0.2)',
                    borderColor: 'rgba(255, 165, 0, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        ticks: {
                            font: {
                                size: 15
                            }
                        }
                    },
                    y: {
                        beginAtZero: true,
                        ticks: {
                            font: {
                                size: 15
                            }
                        }
                    }
                },
                plugins: {
                    legend: {
                        labels: {
                            font: {
                                size: 15
                            }
                        }
                    },
                    title: {
                        display: true,
                        text: 'Emotions Experienced by Our Users To Date',
                        font: {
                            size: 25
                        }
                    }
                }
            }
        });
        });
    </script>
</body>

</html>